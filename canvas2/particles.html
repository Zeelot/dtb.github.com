<!doctype HTML>
<html>
	<head>
		<title>Canvassing</title>
		<style>
			body {
				font-family:"helvetica neue", arial, sans-serif ;
				margin:0;
				padding:0;
			}
			
			
			#whisky {
				padding:0;
				width: 500px;
				height:500px;
				
			}
		</style>
	</head>
	<body>
			<canvas id="whisky" width="500" height="500">
			
			</canvas>
			
			<script>
				var NUM_POINTS = 50;
				var canvas = document.getElementById('whisky');
				var context = canvas.getContext("2d");
				
				var points = [],
					width = canvas.width,
					height = canvas.height;
				
				var gravity = .25;
				
				var emitter = { x: randBtwn(0, width), y: randBtwn(0, height) };
				
				
				function randBtwn(min, max)
				{
					return min + (max - min) * Math.random();
				}
				
				function resetPoint(p)
				{
					p.x  = emitter.x;
					p.y  = emitter.y;
					p.vY = randBtwn(-3, 5);
					p.vX = randBtwn(-3, 5);
					p.radius = randBtwn(3, 6);
				}
				
				function initPoint()
				{	
					var p = { };
					resetPoint(p);
					return p;
				}
				
				function addPoint()
				{
					if(points.length < NUM_POINTS)
						points.push(initPoint());
				}
				
				var circRadius = 4;//pix
				function draw()
				{
					context.clearRect(0, 0, width, height);
					var point, i;
					for(i = 0; i < points.length; i++)
					{
						point = points[i];
						context.beginPath(point.x, point.y);
						context.fillStyle = 'rgba(0,0,0, '+ emitter.y/point.y - 1  +')'
						context.arc(point.x, point.y, point.radius, 0, 2*Math.PI);
						context.fill();
					}
				}
				
				function move(t)
				{
					points.forEach(function(point)
					{
						if((point.y > (height - point.radius) || point.y < point.radius)
							||
							(point.x > (width - point.radius) || point.x < point.radius))
						{
							resetPoint(point);
						}
						point.vY += gravity;
						
						point.x += point.vX;
						point.y += point.vY;
					});
				}
				
				var start = new Date();
				window.setInterval(function(){ addPoint(); move(new Date() - start); draw(); }, 1000/30);
			</script>
	</body>
</html>
